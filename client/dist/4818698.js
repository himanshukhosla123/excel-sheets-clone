(window.webpackJsonp=window.webpackJsonp||[]).push([[8,4,5,6,7],{263:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return r}));"".concat("https://us-central1-angelone-nodejs.cloudfunctions.net/app","/api/demo");var o="".concat("https://us-central1-angelone-nodejs.cloudfunctions.net/app","/api/upload-excel"),l="".concat("https://us-central1-angelone-nodejs.cloudfunctions.net/app","/api/get-user-sheets"),r="".concat("https://us-central1-angelone-nodejs.cloudfunctions.net/app","/api/get-sheet-data")},264:function(t,e,n){"use strict";n.r(e);n(79),n(191),n(190),n(44),n(80);var o={name:"item-row",created:function(){var t=Object.keys(this.source);t.includes("_id")&&t.splice(t.indexOf("_id"),1),this.firstkey=t[0]},props:{onSelect:{type:Function,default:function(){}},index:{type:Number},source:{type:Object,default:function(){return{}}}}},l=n(43),component=Object(l.a)(o,(function(){var t=this;return(0,t._self._c)("div",{staticClass:"break-words px-3 py-2 mb-2 mx-2 min-h-5 cursor-pointer border border-white border-solid",on:{click:function(){return t.onSelect(t.source)}}},[t._v(t._s(t.source[t.firstkey]))])}),[],!1,null,null,null);e.default=component.exports},265:function(t,e,n){"use strict";n.r(e);n(190);var o={name:"item-row-info",props:{index:{type:Number},source:{type:Object,default:function(){return{}}}}},l=n(43),component=Object(l.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"break-words bg-gray-300 p-2 mb-2 min-h-5 cursor-pointer border border-white text-black border-solid"},[t._v(t._s(t.source.key)+":- "),e("br"),t._v(" "+t._s(t.source.value))])}),[],!1,null,null,null);e.default=component.exports},267:function(t,e,n){"use strict";n.r(e);n(44);var o,l,r,c=n(270),d=(n(104),n(190),n(20),n(271)),f=n.n(d),h=n(264),v=n(265),m=n(263),x=(n(81),{name:"ExcelView",components:{"virtual-list":f.a,ItemInfoRow:v.default},props:{files:{type:Array,default:function(){return[]}},activeFileIndex:{type:Number,default:0}},data:function(){return{items:[],isLoading:!1,dataPagination:null,noResultsFound:!1,itemRowComponent:h.default,searchQuery:"",activeRowData:null}},created:function(){this.fileContentMap={},this.abortController=null,this.extraProps={onSelect:this.onRowSelect}},mounted:function(){this.fetchSheetData()},methods:{fetchSheetData:function(){var t,e,n=this,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.files,d=this.activeFileIndex,f=this.searchQuery;if(r&&r.length){var h=r[d];if(h){if(o&&(this.isLoading=!0,this.noResultsFound=!1,this.items=[],this.dataPagination=null),!f&&l&&null!==(t=this.fileContentMap[h.filename])&&void 0!==t&&t.data){console.log("prefill from cache");var v=this.fileContentMap[h.filename];this.items=v.data,this.dataPagination=v.pagination}var x=m.b+"?fileId=".concat(h.filename);if(this.dataPagination){if(!(this.dataPagination.total_page>this.dataPagination.current_page))return;x+="&page=".concat(this.dataPagination.current_page+1)}f&&(x+="&query=".concat(f)),this.abortController&&(null===(e=this.abortController)||void 0===e||e.abort());var w=new AbortController;this.abortController=w;var _=w.signal;return fetch(x,{signal:_}).then((function(t){return t.json()})).then((function(t){console.log(t);var data=t.data,e=t.pagination;if(!Array.isArray(data)||!data.length)throw n.noResultsFound=!0,new Error("No Data Found");n.items=[].concat(Object(c.a)(n.items),Object(c.a)(data)),n.dataPagination=e;var o=n.fileContentMap[h.filename];f||(o?(o.data&&(o.data=[].concat(Object(c.a)(o.data),Object(c.a)(data))),o.pagination&&(o.pagination=e),n.fileContentMap[h.filename]=o):n.fileContentMap[h.filename]={data:data,pagination:e}),console.log(data,e,n.fileContentMap)})).catch((function(t){console.error(t)})).finally((function(){n.isLoading=!1}))}}},selectFile:function(t,e){this.$emit("onFileChange",e)},onScrollToBottom:function(){console.log("at bottom");var t=this.dataPagination;t&&t.total_page!==t.current_page?this.isLoading||(this.isLoading=!0,this.fetchSheetData()):console.warn("reached section end")},onSearch:(o=function(){this.fetchSheetData(!0,!1)},l=100,function(){var t=this,e=arguments;clearTimeout(r),r=setTimeout((function(){return o.apply(t,e)}),l)}),onRowSelect:function(t){console.log("on row select",t),this.activeRowData=t}},watch:{files:function(){this.fetchSheetData()},activeFileIndex:function(){this.searchQuery="",this.fetchSheetData(!0,!0)}}}),w=x,_=n(43),component=Object(_.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"h-screen bg-gray-100 flex flex-col justify-center items-center"},[e("main",{staticClass:"relative overflow-hidden w-96 h-[640px] rounded-2xl bg-black shadow-lg shadow-black/40 p-2 text-white"},[e("div",{staticClass:"relative w-full h-full bg-white rounded-lg flex flex-col"},[e("main",{staticClass:"mt-5 relative mb-14 flex flex-col bg-gray-800 h-full w-full pt-3 w-full text-sm gap-2 text-gray-400 gap-3",staticStyle:{"min-height":"480px"}},[e("div",{staticClass:"flex flex-row justify-center px-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"rounded-md w-full pl-2 py-1 border border-gray-600 bg-gray-800",attrs:{type:"text",placeholder:"Search here"},domProps:{value:t.searchQuery},on:{input:[function(e){e.target.composing||(t.searchQuery=e.target.value)},t.onSearch]}})]),t._v(" "),e("virtual-list",{staticStyle:{"max-height":"420px","overflow-y":"auto"},attrs:{"data-key":"_id","data-sources":t.items,"data-component":t.itemRowComponent,"bottom-threshold":200,"extra-props":t.extraProps},on:{tobottom:function(){return t.onScrollToBottom()}}},[!t.noResultsFound||t.dataPagination&&t.dataPagination.total_page==t.dataPagination.current_page?e("div",{staticClass:"round-loader",attrs:{slot:"footer"},slot:"footer"}):t._e()]),t._v(" "),t.searchQuery&&t.noResultsFound&&!t.isLoading?e("p",{staticClass:"px-3 text-m font-bold"},[t._v('No results found for "'+t._s(t.searchQuery)+'"')]):t._e()],1),t._v(" "),e("nav",{staticClass:"absolute fixed bottom-0 left-0 w-full h-15 rounded-b-lg flex flex-row justify-between items-center text-gray-400 border-t bg-white"},[t._l(t.files,(function(n,o){return[e("button",{key:n._id,class:"flex-1 overflow-hidden flex flex-col p-2 text-black border border-white border-solid ".concat(o==t.activeFileIndex?" bg-white":"bg-gray-200"),on:{click:function(){return t.selectFile(n,o)}}},[e("p",{staticClass:"text-s break-words"},[t._v("File "+t._s(o+1))]),t._v(" "),e("p",{staticClass:"w-full text-left text-xs break-words text-ellipsis overflow-hidden whitespace-nowrap max-h-4"},[t._v(t._s(n.originalname))])])]}))],2),t._v(" "),e("div",{staticClass:"absolute w-full h-full bg-white top-0 p-5 left-0 z-4",style:"transition-duration: 400ms; ".concat(t.activeRowData?"":"transform: translateX(110%)")},[e("button",{staticClass:"p-4 text-black pl-0",on:{click:function(e){t.activeRowData=null}}},[t._v("ðŸ”™ Go Back")]),t._v(" "),e("hr",{staticClass:"mb-4"}),t._v(" "),t.activeRowData?[t._l(Object.keys(t.activeRowData),(function(n){return[e("ItemInfoRow",{key:n,attrs:{source:{key:n,value:t.activeRowData[n]}}})]}))]:t._e()],2)]),t._v(" "),t._m(0)])])}),[function(){var t=this._self._c;return t("div",{staticClass:"absolute fixed top-3 left-0 w-full z-10"},[t("div",{staticClass:"bg-black mx-auto h-3 w-3 rounded-full"})])}],!1,null,null,null);e.default=component.exports},268:function(t,e,n){"use strict";n.r(e);var o={name:"MainHeader"},l=n(43),component=Object(l.a)(o,(function(){this._self._c;return this._m(0)}),[function(){var t=this._self._c;return t("div",{staticClass:"w-full fixed top-0 left-0 bg-green-700 border border-solid border-grey shadow-lg py-4"},[t("h1",{staticClass:"text-lg text-white px-4 inline-block"},[this._v("Angle One Task - Himanshu Khosla")])])}],!1,null,null,null);e.default=component.exports},269:function(t,e,n){"use strict";n.r(e);n(266);var o={name:"ExcelInfoSection",props:{activeFile:{type:Object,default:null}},methods:{getFormattedSize:function(t){if(!t)return"";var e=t/1024,n=e/1024,o=n<1;return parseFloat(o?e:n).toFixed(2)+(o?" Kb":" Mb")}}},l=n(43),component=Object(l.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-grey-100 p-5 h-screen border-solid border-left border-grey"},[e("h2",{staticClass:"text-lg text-black mb-5"},[t._v("File Info")]),t._v(" "),e("img",{staticClass:"max-w-[60px] object-contain",attrs:{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Microsoft_Excel_2013-2019_logo.svg/2170px-Microsoft_Excel_2013-2019_logo.svg.png",width:"60"}}),t._v(" "),e("hr",{staticClass:"mt-4"}),t._v(" "),t.activeFile?[e("div",{staticClass:"mb-5 mt-4"},[e("p",{staticClass:"text-m text-black mb-1"},[t._v("Name")]),t._v(" "),e("p",{staticClass:"text-sm text-grey-900"},[t._v(t._s(t.activeFile.originalname))])]),t._v(" "),e("div",{staticClass:"mb-5"},[e("p",{staticClass:"text-m text-black mb-1"},[t._v("Size")]),t._v(" "),e("p",{staticClass:"text-m text-grey-900"},[t._v(t._s(t.getFormattedSize(t.activeFile.size)))])])]:t._e()],2)}),[],!1,null,null,null);e.default=component.exports},272:function(t,e,n){var content=n(278);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(106).default)("4e361a94",content,!0,{sourceMap:!1})},277:function(t,e,n){"use strict";n(272)},278:function(t,e,n){var o=n(105)((function(i){return i[1]}));o.push([t.i,".round-loader{animation:spin 1.5s linear infinite;border:.25rem solid #f4f4f4;border-radius:50%;border-top-color:#97a0be;height:2rem;margin:1.5rem auto 1rem;width:2rem}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn);-webkit-transform:rotate(1turn)}}",""]),o.locals={},t.exports=o},279:function(t,e,n){"use strict";n.r(e);var o=n(270),l=(n(104),n(20),n(273),n(275)),r=n.n(l),c=n(268),d=n(267),f=n(269),h=n(263),v={name:"MainPage",components:{ExcelView:d.default,Header:c.default,Dropzone:r.a,ExcelInfoSection:f.default},data:function(){return{files:[],activeFileIndex:0,isLoadingSheets:!0}},created:function(){this.MAX_NUMBER_OF_SHEETS=5,this.options={acceptedFiles:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",createImageThumbnails:!1,url:h.a,thumbnailWidth:200,maxFilesize:51200}},mounted:function(){this.fetchUserSheets()},methods:{uploadNewFile:function(){var t=this.$refs.el.dropzone;console.log(t)},fetchUserSheets:function(){var t=this;fetch(h.c).then((function(t){return t.json()})).then((function(e){console.log(e);var data=e.data;if(!Array.isArray(data)||!data.length)throw alert("No Data Found! Please upload one valid excel from below button"),new Error("No Data Found");t.files=data})).catch((function(t){console.error(t)})).finally((function(){t.isLoadingSheets=!1}))},onFileUpload:function(t,e){var n;(console.log(e),200===e.status)?(this.files=[].concat(Object(o.a)(this.files),[e.data]),null===(n=this.$refs.el)||void 0===n||n.removeAllFiles(),this.activeFileIndex=this.files.length-1):alert("Uploading failed")},onFileChange:function(t){this.activeFileIndex=t},onUploadError:function(){var t;null===(t=this.$refs.el)||void 0===t||t.removeAllFiles(),alert("Something went wrong while uploading! Please try later")}}},m=(n(277),n(43)),component=Object(m.a)(v,(function(){var t=this,e=t._self._c;return e("div",{},[t.files.length<t.MAX_NUMBER_OF_SHEETS?e("Dropzone",{ref:"el",staticClass:"fixed bottom-4 right-14 p-3 cursor-pointer px-4 w-64 bg-green-800 w-3/12 rounded text-white text-center",attrs:{id:"foo",options:t.options,"use-custom-slot":!0,"destroy-dropzone":!0},on:{"vdropzone-success":t.onFileUpload,"vdropzone-error":t.onUploadError}},[t._v("\n    Upload new excel\n  ")]):t._e(),t._v(" "),e("Header"),t._v(" "),e("div",{staticClass:"flex w-full flex-row items-center pt-14"},[e("ExcelView",{staticClass:"w-8/12",attrs:{files:t.files,"active-file-index":t.activeFileIndex},on:{onFileChange:t.onFileChange}}),t._v(" "),e("ExcelInfoSection",{staticClass:"w-4/12",attrs:{"active-file":t.files[t.activeFileIndex]}})],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Header:n(268).default,ExcelView:n(267).default,ExcelInfoSection:n(269).default})}}]);